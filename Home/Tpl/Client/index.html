<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>用户管理|<{$configcache['Title']}></title>
  <link rel="stylesheet" type="text/css" href="__CSS__/content.css"  />
  <link rel="stylesheet" type="text/css" href="__CSS__/public.css"  />
  <script type="text/javascript" src="__JS__/jquery.js"></script>
  <script type="text/javascript" src="__JS__/Public.js"></script>
  <script type="text/javascript" src="__JS__/winpop.js"></script>
  <script type="text/javascript" src="__JS__/My97DatePicker/WdatePicker.js"></script>
  <style type="text/css">
  .select{padding:5px 10px;border:#ddd 1px solid;border-radius:4px;width:60%;margin:5% auto;font-size:12px}
  .select li{list-style:none;padding:10px 0 5px 100px}
  .select .select-list{border-bottom:#eee 1px dashed}
  .select dl{zoom:1;position:relative;line-height:24px;}
  .select dl:after{content:" ";display:block;clear:both;height:0;overflow:hidden}
  .select dt{width:100px;margin-bottom:5px;position:absolute;top:0;left:-100px;text-align:right;color:#666;height:24px;line-height:24px}
  .select dd{float:left;display:inline;margin:0 0 5px 5px;}
  .select a{display:inline-block;white-space:nowrap;height:24px;padding:0 10px;text-decoration:none;color:#039;border-radius:2px;}
  .select a:hover{color:#f60;background-color:#f3edc2}
  .select .selected a{color:#fff;background-color:#f60}
  .select-result dt{font-weight:bold}
  .select-no{color:#999}
  .select .select-result a{padding-right:20px;background:#f60 url("__PUBLIC__/image/close.gif") right 9px no-repeat}
  .select .select-result a:hover{background-position:right -15px}
  .tc{text-align:center; text-indent:0;font-family:"微软雅黑";font-size: 14px;color:#111;}
  </style>
</head>
<body>
  <div id="content">
   <h1>首页 > 客户管理 > 客户库</h1>
   <h2>
     <div class="h2_left">
       <a href="__ACTION__" class="whole">全部</a>
       <a href="javascript:;" class="f5" onclick="f5();">刷新</a>
       <a href="javascript:history.back();" class="Retreat">后退</a>
       <a href="javascript:history.go(1);" class="Advance">前进</a>
     </div>
     <div class="search">
      <form method="get" id="search">
        <input type="text" name="k" class="text" value="<{$data['key']}>"/>
        <input type="submit" class="so" value="搜 索" />
      </form>
      <font>小贴士：输入昵称/手机号</font>
    </div>
  </h2>

  <div class="fen">
    <ul class="select" style="height:310px;margin-top: 20px;margin-bottom: 20px;">
      <li class="select-list List_more"> 
        <dl id="select">
          <dt>用户角色：</dt>
            <dd <if condition="$data['userRole'] eq -1"> class="selected select-all"</if>>
              <a href="__APP__/Client/index/userRole/-1">全部</a>
            </dd>          
            <dd <if condition="$data['userRole'] eq 1"> class="selected select-all"</if>>
              <a href="__APP__/Client/index/userRole/1">区域总代理</a>
            </dd>
            <dd <if condition="$data['userRole'] eq 2"> class="selected select-all"</if>>
              <a href="__APP__/Client/index/userRole/2">贸易管家代理商</a>
            </dd>
            <dd <if condition="$data['userRole'] eq 3"> class="selected select-all"</if>>
              <a href="__APP__/Client/index/userRole/3">贸易管家贸易工厂</a>
            </dd>
            <dd <if condition="$data['userRole'] eq 4"> class="selected select-all"</if>>
              <a href="__APP__/Client/index/userRole/4">社区管家代理商</a>
            </dd>
            <dd <if condition="$data['userRole'] eq 5"> class="selected select-all"</if>>
              <a href="__APP__/Client/index/userRole/5">社区管家商铺</a>
            </dd>          
        </dl>
      </li>
      <li class="select-list List_more">
        <dl id="select">
          <dt>实名认证：</dt>
            <dd <eq name="data['userApproveStatus']" value="-1"> class="selected select-all"</eq>>
              <a href="__APP__/Client/index/userApproveStatus/-1">全部</a>
            </dd>
            <dd <eq name="data['userApproveStatus']" value="0"> class="selected select-all"</eq>>
              <a href="__APP__/Client/index/userApproveStatus/0">未认证</a>
            </dd>
            <dd <eq name="data['userApproveStatus']" value="1"> class="selected select-all"</eq>>
              <a href="__APP__/Client/index/userApproveStatus/1">待认证</a>
            </dd>
            <dd <eq name="data['userApproveStatus']" value="2"> class="selected select-all"</eq>>
              <a href="__APP__/Client/index/userApproveStatus/2">已认证</a>
            </dd>
            <dd <eq name="data['userApproveStatus']" value="3"> class="selected select-all"</eq>>
              <a href="__APP__/Client/index/userApproveStatus/3">认证未通过</a>
            </dd>            
        </dl>
      </li>
      <li class="select-list List_more"> 
        <dl id="select">
          <dt>成为管家：</dt>
            <dd <eq name="data['isHouseManager']" value="-1"> class="selected select-all"</eq>>
              <a href="__APP__/Client/index/isHouseManager/-1/isHousekeeperNetred/-1">全部</a>
            </dd>
            <dd <eq name="data['isHouseManager']" value="0"> class="selected select-all"</eq>>
              <a href="__APP__/Client/index/isHouseManager/0/isHousekeeperNetred/0">普通用户</a>
            </dd>
            <dd <eq name="data['isHouseManager']" value="1"> class="selected select-all"</eq>>
              <a href="__APP__/Client/index/isHouseManager/1">私人管家</a>
            </dd>
            <dd <eq name="data['isHouseManager']" value="2"> class="selected select-all"</eq>>
              <a href="__APP__/Client/index/isHousekeeperNetred/1">网红管家</a>
            </dd>
        </dl>
      </li>
      <li class="select-list List_more"> 
        <dl id="select">
          <dt>成为明星逸专员：</dt>
            <dd <eq name="data['userIsStar']" value="-1"> class="selected select-all"</eq>>
              <a href="__APP__/Client/index/userIsStar/-1">全部</a>
            </dd>
            <dd <eq name="data['userIsStar']" value="0"> class="selected select-all"</eq>>
              <a href="__APP__/Client/index/userIsStar/0">未成为明星逸专员</a>
            </dd>
            <dd <eq name="data['userIsStar']" value="1"> class="selected select-all"</eq>>
              <a href="__APP__/Client/index/userIsStar/1">已成为明星逸专员</a>
            </dd>            
        </dl>
      </li>
      <li class="select-list List_more"> 
        <dl id="select">
          <dt>成为代理商：</dt>
            <dd <eq name="data['isAgent']" value="-1"> class="selected select-all"</eq>>
              <a href="__APP__/Client/index/isAgent/-1">全部</a>
            </dd>
            <dd <eq name="data['isAgent']" value="0"> class="selected select-all"</eq>>
              <a href="__APP__/Client/index/isAgent/0">未成为代理商</a>
            </dd>
            <dd <eq name="data['isAgent']" value="1"> class="selected select-all"</eq>>
              <a href="__APP__/Client/index/isAgent/1">已成为代理商</a>
            </dd>            
        </dl>
      </li>
      <li class="select-list List_more"> 
        <dl id="select">
          <dt>视频上传权限：</dt>
            <dd <eq name="data['whiteListStatus']" value="-1"> class="selected select-all"</eq>>
              <a href="__APP__/Client/index/whiteListStatus/-1">全部</a>
            </dd>
            <dd <eq name="data['whiteListStatus']" value="0"> class="selected select-all"</eq>>
              <a href="__APP__/Client/index/whiteListStatus/0">无权限</a>
            </dd>
            <dd <eq name="data['whiteListStatus']" value="1"> class="selected select-all"</eq>>
              <a href="__APP__/Client/index/whiteListStatus/1">有权限</a>
            </dd>            
        </dl>
      </li>
      <li class="select-list List_more"> 
        <dl id="select">
          <dt>用户状态：</dt>
            <dd <eq name="data['registerType']" value="-1"> class="selected select-all"</eq>>
              <a href="__APP__/Client/index/registerType/-1">全部</a>
            </dd>
            <dd <eq name="data['registerType']" value="0"> class="selected select-all"</eq>>
              <a href="__APP__/Client/index/registerType/0">老用户</a>
            </dd>
            <dd <eq name="data['registerType']" value="1"> class="selected select-all"</eq>>
              <a href="__APP__/Client/index/registerType/1">新用户（非会员）</a>
            </dd>
            <dd <eq name="data['registerType']" value="2"> class="selected select-all"</eq>>
              <a href="__APP__/Client/index/registerType/2">新用户（会员）</a>
            </dd>            
        </dl>
      </li>      
    </ul>
  </div>
  <table id="table" border="1" bordercolor="#CCCCCC" cellpadding="0" cellspacing="0">
   <tr>
     <th>昵称</th>
     <th>手机号</th>
     <th>真实姓名</th>
     <th>实名认证</th>
     <th>持股金额</th>
     <th>积分</th>
     <th>保证金</th>
     <th>用户角色</th>
     <th>成为管家</th>
     <th>协议状态</th>
     <th>荣誉值</th>
     <th>账号状态</th>
     <th>是否为明星逸专员</th>
     <th>代理商</th>
     <th>注册时间</th>
     <th>操作</th>       
   </tr>
  <if condition="count($user)">
   <volist name="user" id="vo">
    <tr>
      <td style="text-align:center" class='tc'><{$vo.userNickName}></td>
      <td style="text-align:center" class='tc'><{$vo.userTelephone}></td>
      <td style="text-align:center" class='tc'><{$vo.userRealName}></td>
      <td style="text-align:center" class='tc'>
        <!-- 使用switch标签判断输出 -->
        <switch name="vo.userApproveStatus">
          <case value="0">未认证</case>
          <case value="1">待认证</case>
          <case value="2">已认证</case>
          <case value="3">认证未通过</case>
          <default />
        </switch>
      </td>
      <td class="tc" style="text-align: center"><{$vo.userStockNum}></td>
      <td class="tc" style="text-align: center"><{$vo.memberPoint}></td>
      <td class="tc" style="text-align: center"><{$vo.memberPoint}></td>
      <td style="text-align:center" class='tc'>
        <switch name="vo.userRole">
          <case value="1">区域总代理</case>
          <case value="2">贸易管家代理商</case>
          <case value="3">贸易管家贸易工厂</case>
          <case value="4">社区管家代理商</case>
          <case value="5">社区管家商铺</case>
          <default />
        </switch>
      </td>
      <td style="text-align:center" class='tc'>
        <if condition="$vo.isHouseManager eq 1">私人管家</if> 
        <if condition="$vo.isHousekeeperNetred eq 1">网红管家</if>
      </td>
      <td style="text-align:center" class='tc'>
        <switch name="vo.isSign">
          <case value="0">未签署</case>
          <case value="1">已签署</case>
          <default />
        </switch>
      </td>
      <td class="tc" style="text-align: center"><{$vo.memberGlory}></td>
      <td class='tc' style="text-align:center">
        <switch name="vo.userApproveStatus">
          <case value="0">未认证</case>
          <case value="1">待认证</case>
          <case value="2">已认证</case>
          <case value="3">认证未通过</case>
          <default />
        </switch>
      </td>
      <td class='tc' style="text-align:center">
        <switch name="vo.userIsStar">
          <case value="0"><a href="javascript:;" class="star" approveStatus="3" style="color:#009900" sid='<{$vo.sid}>'>设为VIP管家</a></case>
          <case value="1"><a href="javascript:;" class="nostar" approveStatus="3" style="color:#009900" sid='<{$vo.sid}>'>取消VIP管家</a></case>
          <default /><a href="javascript:;" class="star" approveStatus="3" style="color:#009900" sid='<{$vo.sid}>'>设为VIP管家</a>
        </switch>
      </td>
      <td class="tc" style="text-align: center">
        <if condition="$vo['isAgent'] eq 0">
          <a href="javascript:;" class="isagent" style="color:#FF9933"  userId='<{$vo.sid}>' agent='1'>设置为代理商</a>
          <elseif condition="$vo['isAgent'] eq 1"/>
          <a href="javascript:;" class="isagent"  style="color:#FF9933"  userId='<{$vo.sid}>' agent='0'>取消代理商</a>
          <else/>
        </if>
      </td>
      <td class="tc" style="text-align: center"><{$vo.userCreateDate}></td>
      <td class='tc' style="text-align:center">
        <a href="<{:U('Client/edit')}>?sid=<{$vo.sid}>" class="" style="color:orange;" sid='<{$vo.sid}>'>编辑</a>&nbsp;&nbsp;
        <!-- 使用switch标签判断输出 -->
        <switch name="vo.userApproveStatus">
         <case value="0"><a href="javascript:;" class="details" approveStatus="4" style="color:#0000FF" sid='<{$vo.sid}>' name='<{$vo.userNickName}>'>详情</a></case>
         <case value="1"><a href="javascript:;" class="details" approveStatus="4" style="color:#0000FF" sid='<{$vo.sid}>' name='<{$vo.userNickName}>'>详情</a>&nbsp;&nbsp;<a href="javascript:;" class="pass" approveStatus="2" style="color:#FF9933" sid='<{$vo.sid}>' userId='<{$admin.ID}>' userName='<{$admin.Username}>'>通过</a>&nbsp;&nbsp;<a href="javascript:;" class="nopass" approveStatus="3" style="color:#FF9933" sid='<{$vo.sid}>' userId='<{$admin.ID}>' userName='<{$admin.Username}>'>不通过</a></case>
         <case value="2"><a href="javascript:;" class="details" approveStatus="4" style="color:#0000FF" sid='<{$vo.sid}>' name='<{$vo.userNickName}>'>详情</a></case>
         <case value="3"><a href="javascript:;" class="details" approveStatus="4" style="color:#0000FF" sid='<{$vo.sid}>' name='<{$vo.userNickName}>'>详情</a></case>
         <default />未知
       </switch>
     </td>
   </tr> 
 </volist>
  <else />
      <tr><td style="text-align:center" colspan="16" class='tc'>当前请求无数据</td></tr>
  </if>
</table>
<div id="page">
  <{$page}>
</div>
</div>
<script type="text/javascript">
$(function (){
 $('.nopass').click(function(){
  var approveStatus = parseInt($(this).attr('approveStatus'));
  var sid= ($(this).attr('sid'));
  var checkUserId = $(this).attr('userId');
  var checkUserName = $(this).attr('Username');
  popload('拒绝原因',600,300,'__APP__/Client/nopa/sid/'+sid+'/approveStatus/'+approveStatus+'/checkUserId/'+checkUserId+'/checkUserName/'+checkUserName);
  addDiv($('#iframe_pop'));
  popclose();
 // location.reload();
});

 $('.pass').click(function(){
  var approveStatus = parseInt($(this).attr('approveStatus'));
  var sid= ($(this).attr('sid'));
  var userId = $(this).attr('userId');
  var Username = $(this).attr('Username');
  $.ajax({
   type: "POST",
   url: "<{$url}>/manager/user/applyUser",
   data: {approveStatus:approveStatus,sid:sid,userId:userId,Username:Username}, 
   success: function(msg){
    alert(msg.message);
    f5();
  }
});
});



 $('.details').click(function(){
  var approveStatus = parseInt($(this).attr('approveStatus'));
  var sid= ($(this).attr('sid'));
  event.preventDefault();
  popload('详情信息',860,800,'__APP__/Client/user/sid/'+sid);
  addDiv($('#iframe_pop'));
  popclose();
});


//登录日志
$('.login').click(function(){
  var sid= ($(this).attr('sid'));
  var userNickName = $(this).attr('userNickName');
  event.preventDefault();
  popload('登录日志',960,800,'__APP__/Client/login/userNickName/'+userNickName);
  addDiv($('#iframe_pop'));
  popclose();
});
});


//设为明星专员
$('.star').click(function(){
  var sid= ($(this).attr('sid'));

  $.ajax({
   type: "POST",
   url: "<{$url}>/manager/user/changeUserIsStar",
   data: {userId :sid,isStar:'true'}, 
   success: function(msg){
    if(msg.code == "2000"){
      alert(msg.message);
      f5();
    }
  },
  error:function(){
    alert('异常!');
  }
});

});

//取消明星专员
$('.nostar').click(function(){
  var sid= ($(this).attr('sid'));

  $.ajax({
   type: "POST",
   url: "<{$url}>/manager/user/changeUserIsStar",
   data: {userId :sid,isStar:'false'}, 
   success: function(msg){
    if(msg.code == "2000"){
      alert(msg.message);
      f5();
    }

  },
  error:function(){
    alert('异常!');
  }
});

});

$('.isagent').click(function(){
  var userId= ($(this).attr('userId'));
  var isAgent = ($(this).attr('agent'));
  $.ajax({
   type: "POST",
   url: "<{$url}>/manager/user/setAgent",
   data: {userId:userId,isAgent:isAgent}, 
   success: function(msg){
    alert('操作成功');
    f5();
  }
});
});
</script>
</body>
</html>
